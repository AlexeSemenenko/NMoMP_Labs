from math import e, sin, cos
from progonka import solve

if __name__ == "__main__":
    N = 10
    h = 1 / N


    def d(i):
        if i == N:
            return 2 * e * (1 - e ** (- h / 2)) / h
        elif i == 0:
            return 2 * (e ** (h / 2) - 1) / h
        return e ** (i * h - h / 2) / h * (e ** h - 1)


    def phi(i):
        if i == N:
            return 2 * (cos(1 - h / 2) - cos(1)) / h
        elif i == 0:
            return 2 * (1 - cos(h / 2)) / h
        return 2 / h * sin(i * h) * sin(h / 2)


    def A(i):
        return h * e ** (i * h) / (e ** h - 1)


    a = [- A(i) / h ** 2 for i in range(1, N)] + [- A(N) / h]
    b = [- A(1) / h] + [- A(i + 1) / h ** 2 for i in range(1, N)]
    c = [- A(1) / h - h / 2 * d(0)] + [-(A(i + 1) + A(i)) / h ** 2 - d(i) for i in range(1, N)] + [
        - A(N) / h - 1 - h / 2 * d(N)]
    f = [- h / 2 * phi(0)] + [-phi(i) for i in range(1, N)] + [- h / 2 * phi(N)]

    # print(*solve(N, a, c, b, f), sep='\n')

    # l2 = [0.17366254894314717,
    #       0.1743909356860633,
    #       0.17585097388167245,
    #       0.17729897350305435,
    #       0.17821460809454373,
    #       0.1782567106818937,
    #       0.1772258059139997,
    #       0.17503254205949592,
    #       0.1716712751589155,
    #       0.16719813721992385,
    #       0.16171299202499725]
    #
    # l1 = [0.17255791523483074,
    #       0.1734207048110049,
    #       0.1749926353214347,
    #       0.17653234334997686,
    #       0.17752165622985433,
    #       0.17762138440770914,
    #       0.1766338536752446,
    #       0.1744713400986637,
    #       0.1711296592834137,
    #       0.166666241308248,
    #       0.1611820944373395]
    #
    # l3 = [0.17414867245295076,
    #       0.17478329408718926,
    #       0.1761660131942907,
    #       0.17755001475458906,
    #       0.17841246296919247,
    #       0.1784101775859374,
    #       0.1773420685928054,
    #       0.17511748902456523,
    #       0.17172975495431128,
    #       0.16723416187165976,
    #       0.16172989878612157]
    #
    # for i in range(10):
    #     print(l3[i] - l2[i])
